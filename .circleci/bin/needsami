#! /usr/bin/env bash

set -o errexit
set -o nounset
set -o pipefail
set -o noclobber

needsami() {
  # TODO: We could probably build a new AMI if either the packer files have changed or
  # the pip dependencies have changed. For now, we'll just check the statically configured
  # version
  git diff --name-only "$(git merge-base main HEAD)"..HEAD -- .packer/ami-version.txt | grep -q .packer/ami-version.txt

  if [[ $? -eq 0 ]]; then
    return 0
  else
    return 1
  fi
}
