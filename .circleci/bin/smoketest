#!/usr/bin/env bash

[[ "$TRACE" ]] && set -o xtrace
set -o errexit
set -o nounset
set -o pipefail
set -o noclobber

ENDPOINT=$1
CLIENT_ID=tariff
CLIENT_SECRET=$(echo "$FPO_CLIENT_KEYS" | jq -r .tariff)

STATUS_CODE=$(curl -s -o /dev/null -w "%{http_code}" "${ENDPOINT}/fpo-code-search?q=grilled+cheese&digits=6" \
  -H "X-Api-Client-Id: $CLIENT_ID" \
  -H "X-Api-Secret-Key: $CLIENT_SECRET")

if [[ "$STATUS_CODE" -ne 200 ]] ; then
  echo "ERROR: Status code of $STATUS_CODE"
  exit 1
else
  echo "SUCCESS: Status code of $STATUS_CODE"
  exit 0
fi
